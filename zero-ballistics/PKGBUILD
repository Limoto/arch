# Contributor: Jakub Luzny <limoto94@gmail.com>
pkgname=zero-ballistics
pkgver=2.0
pkgrel=5
_pkgname=zb_20
pkgdesc='A unique blend of multiplayer first person shooter and tank combat game'
arch=('i686' 'x86_64')
url='http://www.zeroballistics.com/'
license=('GPL')
[ "${CARCH}" == "i686" ]   && depends=('libgl' 'libjpeg6')
[ "${CARCH}" == "x86_64" ] && depends=('lib32-libgl' 'lib32-libjpeg6')
source=(http://downloads.sourceforge.net/zeroballistics/release/linux/$_pkgname.tar.bz2
http://www.zeroballistics.com/public/readme.html
launcher.sh
launcher-ded.sh
zero-ballistics.desktop)
md5sums=('f7da546621c988d96d0c702e1cca4d04'
         'd9490617a757ad6c3253d995ba84be57'
         'ce4c1ae50295b25bdebf0744b0935df2'
         '4959b744ddee2eb66fe6cc90e32c1d43'
         '95c9a541679510597a737b63cbd72c4f')

build() {
  cd "$srcdir/$_pkgname"

  #fix sound not working issue
  rm 'shared_libs/libasound.so.2'

  mkdir -p "$pkgdir/opt/$pkgname/"
  cp -r 'config_client.xml' \
  'config_common.xml'\
  'config_server.xml'\
  'data'\
  'ranking.pub'\
  'shared_libs'\
  "$pkgdir/opt/$pkgname"

  #game crashes when connecting without write rights
  find "$pkgdir/opt/$pkgname/data/" -type f -exec chmod 666 {} \;

  install -Dm 755 'tank.x86' "$pkgdir/opt/$pkgname"
  install -Dm 755 'server_ded.x86' "$pkgdir/opt/$pkgname"
  
  cd "$srcdir"
  install -Dm 755 'launcher.sh' "$pkgdir/usr/bin/zero-ballistics"
  install -Dm 755 'launcher-ded.sh' "$pkgdir/usr/bin/zero-ballistics-ded"
  install -Dm 644 'readme.html' "$pkgdir/usr/share/doc/zero-ballistics/README.html"
  install -Dm 644 'zero-ballistics.desktop' "$pkgdir/usr/share/applications/zero-ballistics.desktop"

}

#category: games
# vim:set ts=2 sw=2 et:
